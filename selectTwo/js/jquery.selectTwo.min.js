!function(e){function t(e){return e&&"[object Array]"===Object.prototype.toString.call(e)}e.fn.select2.amd.define("CustomResults",["jquery","select2/utils","select2/results"],function(e,t,n){n.prototype.option=function(t){if(t.hidden)return null;var n,a=!1;t.children?(n=e('.select2-results__option[aria-label="'+t.text+'"]')[0],0===e(n).length?(n=document.createElement("li")).className="select2-results__option":a=!0):(n=document.createElement("li")).className="select2-results__option";var i={role:"treeitem","aria-selected":"false"};for(var r in t.customClass&&e(n).addClass("custom-class"),t.disabled&&(delete i["aria-selected"],i["aria-disabled"]="true"),null==t.id&&delete i["aria-selected"],null!=t._resultId&&(n.id=t._resultId),t.title&&(n.title=t.title),t.children&&(i.role="group",i["aria-label"]=t.text,delete i["aria-selected"]),i){var l=i[r];n.setAttribute(r,l)}if(t.children){var o=e(n),s=document.createElement("strong");s.className="select2-results__group";e(s);this.template(t,s);for(var c,d=[],u=0;u<t.children.length;u++){var p=t.children[u],h=this.option(p);d.push(h)}(c=a?o.find(".select2-results__options--nested"):e("<ul></ul>",{class:"select2-results__options select2-results__options--nested"})).append(d),a||(o.append(s),o.append(c))}else this.template(t,n);return e.data(n,"data",t),n}}),e.fn.select2.amd.define("CustomSelectAdapter",["select2/data/select"],function(t){t.prototype.query=function(t,n){var a=[],i=this;this.$element.children().each(function(){var n=e(this);if(n.is("option")||n.is("optgroup")){var r=i.item(n),l=i.matches(t,r,a);null!==l.data&&a.push(l.data)}}),n({results:a})},t.prototype.matches=function(e,t,n){return this.options.get("matcher")(e,t,n)},t.prototype.current=function(t){var n=[],a=this;this.$element.find("option").each(function(){var t=e(this);if(this.selected){var i=a.item(t);n.push(i)}}),t(n)}}),e.fn.select2.amd.define("CustomSearch",["jquery","select2/utils","select2/keys","select2/selection/search"],function(e,t,n,a){a.prototype.searchRemoveChoice=function(e,t){this.trigger("unselect",{data:t})}}),e.fn.select2.amd.define("CustomSingleSelection",["jquery","select2/selection/base","select2/utils","select2/keys","select2/selection/single"],function(e,t,n,a,i){i.prototype.update=function(e){if(0!==e.length){var t=e[0],n=this.$selection.find(".select2-selection__rendered"),a=this.display(t,n);n.empty().append(a),n.attr("title",a||t.title||t.text)}else this.clear()}}),e.fn.select2.amd.define("CustomMultipleSelection",["jquery","select2/selection/base","select2/utils","select2/selection/multiple"],function(e,t,n,a){a.prototype.update=function(e){if(this.clear(),0!==e.length){for(var t=[],a=0;a<e.length;a++){var i=e[a],r=this.selectionContainer(),l=this.display(i,r);r.append(l),r.attr("title",l||i.title||i.text),r.attr("data-id",i.id||""),n.StoreData(r[0],"data",i),t.push(r)}var o=this.$selection.find(".select2-selection__rendered");n.appendMany(o,t)}}});var n=100;function a(t,a){if(a.group){var i=[];return t.forEach(function(t){t.idField=t.id,t.textField=t.matchField,t.maxItemShow=t.maxItemShow||n,t.data=e.map(t.data,function(e){(e=a.beforeBinding(e)).matchField=t.matchField,e.resultFormat=t.resultFormat,t.selectedFormat=t.selectedFormat,e.id=e.id||e[t.idField];var n=[];return t.textField.forEach(function(t){e[t]&&n.push(e[t])}),e.text=e.text||n.join(""),e}),(t.data.length||a.groupEmptyTitleShow)&&i.push({id:t.id,text:t.title,children:t.data,maxItemShow:t.maxItemShow})}),i}return a.idField=a.id,a.textField=a.matchField,t=e.map(t,function(e){(e=a.beforeBinding(e)).id=e.id||e[a.idField];var t=[];return a.textField.forEach(function(n){e[n]&&t.push(e[n])}),e.text=e.text||t.join(""),e})}e.fn.selectTwo=function(i,r){var l={useSelect2:!1,data:[],allowClear:!0,multiple:!1,width:"153px",placeholder:"请选择",id:"id",matchField:["text"],resultFormat:"",selectedFormat:"",notMatched:!1,labelPreventDefault:!0,maxItemShow:n,maxSelectedItem:-1,minInputLength:-1,minInputText:"请至少输入%min%个字",noResultText:"没有匹配结果",searchingText:"查询中...",loadingMoreText:"加载中...",maxSelectedText:"只能选择%max%项",inModal:!1,zIndex:29891016,ajax:null,group:!1,groupTitleShow:!0,groupEmptyTitleShow:!0,change:function(e,t,n){},beforeBinding:function(e){return e}},o={delay:250,url:"url",data:function(e){return{k:e.term}},success:function(e,t){return{data:e="string"==typeof e?JSON.parse(e):e}},processResults:function(e,t){return{results:e}}},s={updateData:function(e,t){e.empty(),e.html("<option />"),t=a(t,e.data("select2").options.options);var n=e.data("select2").dataAdapter;n.addOptions(n.convertToOptions(t))},updateValue:function(n,a){var i,r,l,o;(n.val(a),t(a))?(n.data("preserved-order",a),"object"==typeof a&&a.forEach&&a.forEach(function(e){var t,a=n.find("optgroup");a.length?((t=a.children("[value="+e+"]")).detach(),a.append(t)):((t=n.children("[value="+e+"]")).detach(),n.append(t))}),n.trigger("change",!0),r=(i=n).data("preserved-order")||[],l=i.next(".select2-container").find("li.select2-selection__choice"),o=l.last().next(),"object"!=typeof r&&(r=[r]),r.forEach(function(t){var n=l.filter(function(n,a){return e(a).attr("data-id")===t});o.before(n)})):n.trigger("change")},destroy:function(e,t){e.select2("destroy"),e.off("select2:close select2:open select2:select select2:unselect change"),t&&e.empty()},close:function(e,t){e.select2("close")},open:function(e,t){e.select2("open")}};if("string"==typeof i)return s[i]&&this.each(function(){var t=e(this);t.data("select2")&&s[i](t,r)}),this;if((r=i).useSelect2)return this.select2(r),this;if(this.css("width",r.width||l.width),r.ajax){var c=e.extend(!0,{},l);c.ajax=o;var d=e.extend(!0,{},c,r)}else d=e.extend(!0,{},l,r);return d.minimumInputLength=d.minInputLength,d.maximumSelectionLength=d.maxSelectedItem,d.tags=d.notMatched,d.language={inputTooShort:function(e){return 1===e.minimum?"请输入":d.minInputText.replace("%min%",e.minimum)},noResults:function(){return d.noResultText},searching:function(){return d.searchingText},loadingMore:function(){return d.loadingMoreText},maximumSelected:function(e){return d.maxSelectedText.replace("%max%",e.maximum)}},d.ajax?d.ajax.processResults=function(e,t){var n=d.ajax.success(e,t),i=n.data;return d.group?d.group.forEach(function(e){e.data=i[e.groupKey]||[]}):d.data=i,d.data=a(d.group||d.data,d),n.results=d.data,n}:d.data=a(d.group||d.data,d),this.each(function(){!function(n,a){a.multiple?(a.allowClear=!1,n.find('option[value=""]').remove()):!n.find('option[value=""]').length&&n.prepend('<option value="" />');var i=e.extend(!0,{Search:e.fn.select2.amd.require("CustomSearch"),Results:e.fn.select2.amd.require("CustomResults"),SelectAdapter:e.fn.select2.amd.require("CustomSelectAdapter"),SingleSelection:e.fn.select2.amd.require("CustomSingleSelection"),MultipleSelection:e.fn.select2.amd.require("CustomMultipleSelection"),matcher:function(t,n,r){if(""===e.trim(t.term)&&n.text)return{data:n};if(void 0===n.text||""===n.text||""===n.id||i.group&&void 0===n.children)return{data:null};var l=t.term.toLowerCase();if(a.group){var o=[];if(n.children.forEach(function(e){e.matchField.forEach(function(t){if(e[t]&&-1!==e[t].toLowerCase().indexOf(l))return o.push(e),!1})}),o.length){var s=e.extend(!0,{},n);return s.children=o,{data:s}}return{data:null}}var c=!1;return i.matchField.forEach(function(e){if(n[e]&&-1!==n[e].toLowerCase().indexOf(l))return c=!0,!1}),c?{data:e.extend(!0,{},n)}:{data:null}},sorter:function(t){if(i.group){var r=e.extend(!0,[],t),l=e(".my-select").val()||[];return l="string"==typeof l?[l]:l,r.forEach(function(e){if(e.children){for(var t=e.maxItemShow,n=e.children.slice(0,t),i=!1,r=t;r<e.children.length;++r)for(var o=0;o<l.length;++o)e.children[r][a.idField]===l[o]&&(i=!0,n.push(e.children[r]));i&&n.splice(t-l.length,l.length),e.children=n}}),r}var o=i.maxItemShow,r=t.slice(0,o),s=!1,l=n.val()||[];l="string"==typeof l?[l]:l;for(var c=o;c<t.length;++c)for(var d=0;d<l.length;++d)t[c][a.idField]===l[d]&&(s=!0,r.push(t[c]));return s&&r.splice(o-l.length,l.length),r},templateResult:function(e){var t=i.group?e.resultFormat:i.resultFormat,n=t;if(!n||e.loading)return e.text;for(var a in e)if(e.hasOwnProperty(a)){var r=new RegExp("%"+a+"%","gi");n=n.replace(r,e[a])}return n===t&&i.tags?e.text:n},templateSelection:function(e){var t=i.group?e.resultFormat:i.resultFormat,n=i.group?e.selectedFormat:i.selectedFormat,a=n||t;if(!a||e.text===i.placeholder)return e.text;for(var r in e)if(e.hasOwnProperty(r)){var l=new RegExp("%"+r+"%","gi");a=a.replace(l,e[r])}return a===(n||t)&&i.tags?e.text:a}},a);n.select2(i).on("select2:close",function(t){var n=e(this).data("select2");n.$selection.removeClass("no-top no-bottom"),i.inModal&&n.$dropdown.css("z-index",1),setTimeout(function(){n.$selection.find(".select2-search__field").focus()},0)}).on("select2:open",function(t){var n=e(this).data("select2");i.inModal&&n.$dropdown.css("z-index",i.zIndex),n.$dropdown.find(".select2-dropdown--above").length?(n.$dropdown.addClass("no-margin-top"),n.$selection.addClass("no-top").removeClass("no-bottom")):(n.$dropdown.removeClass("no-margin-top"),n.$selection.addClass("no-bottom").removeClass("no-top"))}).on("select2:select",function(n){if(i.ajax){var a=e(this);i.change(a,n.params.data,a.val())}else if(t(e(this).val())){var r=n.params.data.id,l=e(n.target).children("[value="+r+"]");l.detach(),e(n.target).append(l).trigger("change",!0)}}).on("select2:unselect",function(n){if(i.ajax){var a=e(this);i.change(a,n.params.data,a.val())}else if(t(e(this).val())){var r=n.params.data.id,l=e(n.target).children("[value="+r+"]");l.detach(),e(n.target).append(l).trigger("change",!0)}}).on("change",function(n,a){if(!(i.ajax||t(e(this).val())&&!a)){var r=e(this),l=[],o={},s=[].concat(r.val());if(i.group)return i.group.forEach(function(e){var t=[];e.data.forEach(function(e){if(-1!==s.indexOf(e.id)&&(t[s.indexOf(e.id)]=e,!i.multiple))return!1}),i.multiple?o[e.id]=t:o[e.id]=t[0]}),void i.change(r,o,i.multiple?s:s[0]);i.data.forEach(function(e){if(-1!==s.indexOf(e.id)&&(l[s.indexOf(e.id)]=e,!i.multiple))return!1}),i.multiple?i.change(r,l,s):i.change(r,l[0],s[0])}}),i.labelPreventDefault&&n.closest("label").on("click",function(e){e.preventDefault()});var r=n.data("select2");i.group&&!i.groupTitleShow&&r.$dropdown.addClass("select2-results__groupHide");r.$selection.css("width",i.width)}(e(this),d)}),this}}(jQuery);
